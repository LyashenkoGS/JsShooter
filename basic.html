<!doctype html>
<html lang="">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
    <script src="https://code.jquery.com/ui/1.11.0/jquery-ui.js"></script>


    <link rel="stylesheet" type="text/css" href="./styles/main.css">


    <title>JsShooter</title>


</head>
<body>
<input id="photo" type="file">
<button id="changePhoto" style=" float: right"> changePhoto</button>
<div id="canvas" style="height: 100%">
    <div id="info"></div>
    <img id="cross" src="images/cross.png">

    <div id="target">
        <img id="targetImg" src="images/simple_target.png">

    </div>
    <img src="images/bullet_hole.png">

    <div id="box">
        myBox`
    </div>

 <div id="gun" style="margin-left: 45%;
    margin-top: 15%"> <img  src="./images/gun.png"></div>
</div>

<script type="text/javascript">
    $(document).ready(function () {
        var boxElement = document.getElementById('target')
        var directionTop = 5
        var directionLeft = 5
        boxElement.style.top = "0"
        boxElement.style.left = "0"
        var move = false
        var timeout

        function loop(event) {
            if (move) {
                myWidth = window.innerWidth;
                myHeight = window.innerHeight


                if (parseInt(boxElement.style.top) + boxElement.offsetHeight > myHeight || parseInt(boxElement.style.top) < 0) {
                    directionTop = -directionTop
                    console.log(directionTop)
                }

                boxElement.style.top = (parseInt(boxElement.style.top) + directionTop) + "px"

                if (parseInt(boxElement.style.left) + boxElement.offsetWidth > myWidth || parseInt(boxElement.style.left) < 0) {
                    directionLeft = -directionLeft
                }
                boxElement.style.left = (parseInt(boxElement.style.left) + directionLeft) + "px"
                // console.log(boxElement.style.top+":top")
                //console.log(boxElement.style.left+":left")

                timeout = setTimeout(loop, 33);
            }
        }

        function stop(event) {
            if (event.keyCode == 80 && move == false) {
                move = true
                loop()
            }
            else {
                move = false
                clearInterval(timeout)
            }
        }

        document.onkeydown = stop

        var canvas = document.getElementById('canvas')

        var target = document.getElementById('target')
        target.addEventListener("click", hit);


        var changePhotoButton=document.getElementById('changePhoto')
        changePhotoButton.addEventListener("click",changePhoto)

        function changePhoto(){
            var targetImage=document.getElementById('targetImg')
            var photo=document.getElementById("photo")
            var photoName=photo.value
            var photoSliced=photoName.slice(12)
            targetImage.src=photoSliced
            console.log(photoSliced)


        }

        function shot(){
            var gun= document.getElementById("gun")
            console.log(gun.style.marginTop)
            gun.style.marginTop=parseInt(gun.style.marginTop)-2 +"%"
            console.log(gun.style.marginTop)
            setTimeout( function(){gun.style.marginTop=parseInt(gun.style.marginTop)+2 +"%"}, 100 );
        }

        function hit(event) {
            console.log("hit")
            var img = document.createElement("img");
            img.src = "images/bullet_hole.png";

            var x = event.clientX;     // Get the horizontal coordinate
            var y = event.clientY;     // Get the vertical coordinate
            var coor = "X coords: " + x + ", Y coords: " + y;
            console.log(coor)
            img.style.left = x - 25 - parseInt(target.style.left) + "px"
            img.style.top = y - 25 - parseInt(target.style.top) + "px"
            img.className = "hole"
            var src = target
            src.appendChild(img)
            var audio = new Audio('./sounds/gun-gunshot-01.mp3');
            audio.play();
            autoplay = true
          shot()

        }



    });//END DOCYMENT.READY

</script>
<!-- Built with love using Web Starter Kit -->
</body>
</html>
